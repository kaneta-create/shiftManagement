import{a as N,r as Y,k as j,w as b,o as c,c as d,i as r,l as E,e,t as u,m as x,n as v,F as k,g as D,u as w,v as O,h as I}from"./app-6bd2b245.js";import"./index-42301fcb.js";const T={class:"modal",id:"modal-1"},A={class:"modal__overlay",tabindex:"-1","data-micromodal-close":""},B={class:"bg-white w-2/5 p-8 rounded-lg shadow-sm items-center",role:"dialog","aria-modal":"true","aria-labelledby":"modal-1-title"},H=e("header",{class:""},[e("h2",{class:"text-2xl font-bold text-center border-b pb-2 text-indigo-600",id:"modal-1-title"}," シフト変更 ")],-1),J={class:"modal__content",id:"modal-1-content"},R={class:"flex flex-col space-y-4"},q={class:"mb-4"},z={class:"text-center text-lg"},F={class:"flex items-center"},L=e("label",{class:"text-gray-700 text-nowrap w-1/4 text-center ml-1"},"出勤 / 休日 ：",-1),G={class:"ml-1 w-full flex justify-around"},K={class:"flex items-center"},P=e("span",{class:"mr-4"},"出勤",-1),Q={class:"flex items-center"},W=e("span",null,"休日",-1),X={class:"flex items-center"},Z=e("label",{for:"clock_in",class:"text-gray-700 text-nowrap w-1/3 text-center"},"出勤時間 ：",-1),tt=["disabled"],et=e("option",{value:"",disabled:""},"選択",-1),ot=["value"],st={class:"flex items-center"},at=e("label",{for:"clock_out",class:"text-gray-700 text-nowrap w-1/3 text-center"},"退勤時間 ：",-1),lt=["disabled"],it=e("option",{value:"",disabled:""},"選択",-1),nt=["value"],ct={key:0,class:"text-red-500 text-sm"},ut={__name:"RequestShiftModal",props:{date:String,full_date:String,Ymd_date:String,userId:Number,shifts:Array,errors:Object,day_of_week:String},emits:["updateShiftData"],setup(S,{emit:M}){const _=N(!1),f=()=>{_.value=!_.value},l=S,i=l.shifts.filter(a=>a.full_date==l.Ymd_date&&a.employee_id==l.userId&&a.clock_in!=a.clock_out);function h(a){if(a==2400)return"24:00";{const s=String(Math.floor(a/100)).padStart(2,"0"),o=String(a%100).padStart(2,"0");return`${s}:${o}`}}let n=[];i.length>0?(i[0].clock_out==2400&&(i[0].clock_out=2359),n=[{clock_in:h(i[0].clock_in),clock_out:h(i[0].clock_out),full_date:i[0].full_date,isDayOff:"0"}]):n=[{clock_in:null,clock_out:null,isDayOff:""}];const t=Y({isDayOff:"",clock_in:n[0].clock_in?n[0].clock_in:"",clock_out:n[0].clock_out?n[0].clock_out:"",date:"",employee_id:l.userId});j(()=>{t.date=l.Ymd_date}),b(()=>l.Ymd_date,a=>{t.date=a});const C=M,m=[],U=()=>{if(t.isDayOff===""){console.error("出勤か休日のいずれかを選択してください。"),alert("出勤か休日のいずれかを選択してください。");return}if(t.isDayOff==0&&t.clock_in==""){alert("出勤時間を入力してください");return}else if(t.isDayOff==0&&t.clock_out==""){alert("退勤時間を入力してください");return}if(m.some(o=>o.date===t.date)){alert("既に入力済みです。");return}let s={isDayOff:t.isDayOff,clock_in:t.clock_in,clock_out:t.clock_out,date:t.date,employee_id:t.employee_id};m.push(JSON.parse(JSON.stringify(s))),f(),C("updateShiftData",m)};b(t,a=>{Object.keys(a).forEach(s=>{const o=a[s];if(o&&o.start_time&&o.end_time){const p=o.start_time,y=o.end_time;p>=y&&console.error(`${s} の出勤時間は退勤時間より前に設定してください。`)}})});const V=()=>{const a=[];for(let s=0;s<24;s++)for(let o=0;o<60;o+=15){const p=String(s).padStart(2,"0"),y=String(o).padStart(2,"0");a.push(`${p}:${y}`)}return a.push("23:59"),a},$=()=>{alert("変更できるのは今日以降のみです。")},g=V();return(a,s)=>(c(),d(k,null,[r(e("div",T,[e("div",A,[e("div",B,[H,e("main",J,[e("div",R,[e("div",q,[e("p",z,u(l.full_date)+" ("+u(l.day_of_week)+"曜日)",1)]),e("div",F,[L,e("div",G,[e("div",K,[r(e("input",{name:"isDayOff",type:"radio",value:"0","onUpdate:modelValue":s[0]||(s[0]=o=>t.isDayOff=o),class:"mr-1"},null,512),[[x,t.isDayOff]]),P]),e("div",Q,[r(e("input",{name:"isDayOff",type:"radio",value:"1","onUpdate:modelValue":s[1]||(s[1]=o=>t.isDayOff=o),class:"mr-1"},null,512),[[x,t.isDayOff]]),W])])]),e("div",X,[Z,r(e("select",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.clock_in=o),disabled:t.isDayOff==="1",class:v([{"bg-gray-200":t.isDayOff==="1","cursor-not-allowed":t.isDayOff==="1"},"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"]),id:"clock_in"},[et,(c(!0),d(k,null,D(w(g),o=>(c(),d("option",{key:o,value:o},u(o),9,ot))),128))],10,tt),[[O,t.clock_in]])]),e("div",st,[at,r(e("select",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.clock_out=o),disabled:t.isDayOff==="1",class:v([{"bg-gray-200":t.isDayOff==="1","cursor-not-allowed":t.isDayOff==="1"},"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"]),id:"clock_out"},[it,(c(!0),d(k,null,D(w(g),o=>(c(),d("option",{key:o,value:o},u(o),9,nt))),128))],10,lt),[[O,t.clock_out]])]),t.clock_in&&t.clock_out&&t.clock_in>=t.clock_out?(c(),d("div",ct," 出勤時間は退勤時間より前に設定してください。 ")):I("",!0)])]),e("footer",{class:"modal__footer mt-4"},[e("div",{class:"flex justify-between"},[e("button",{onClick:f,type:"button",class:"modal__btn","data-micromodal-close":"","aria-label":"Close this dialog window"},"閉じる"),e("button",{type:"button",onClick:U,class:"text-white bg-indigo-600 border-0 text-sm px-4 py-3 focus:outline-none hover:bg-indigo-700 rounded"},"保存")])])])])],512),[[E,_.value]]),e("td",null,[e("button",{onClick:s[4]||(s[4]=o=>new Date(l.Ymd_date)>=new Date().setHours(0,0,0,0)?f():$()),class:"text-center",type:"button"},u(l.date),1)])],64))}};export{ut as _};
